import json
import os

# 定义7大类
# categories = {
#     "人物": ["历史人物", "文化人物", "政治人物", "经济人物", "艺人", "演员", "作曲家", "歌手", "人物", "足球运动员", "虚拟人物", "导演", "主任", "运动员", "政治官员", "学者", "作家", "政府官员", "大学教授", "编剧", "企业家", "教授", "女生"],
#     "地点": ["乡", "村", "市", "县", "区", "省", "行政区划", "街道", "地理区域", "镇", "车站", "楼盘", "住宅场所", "公寓", "别墅", "住宿场所", "场所", "桥梁", "伏牛路142号院"],
#     "自然科学": ["卫星", "星座", "星体", "星系", "星云", "酸碱值", "化学物质", "猜想", "排名算法", "药物",  "粒子", "抑菌试验", "生物反应调节物", "功能高分子材料", "预防等级", "水稻品种", "病症", "药品", "分级基金", "三维凸均匀体", "裤型代码", "数字化工作证", "存活时间", "系统图", "仪器", "人体疾病", "病症名称", "杀虫剂", "解剖学", "化学品", "有机物", "小细支气管"],
#     "组织机构": ["公司", "企事业单位"],
#     "实体": ["汽车", "虚拟物品", "物品", "设计", "时装", "动物", "微生物", "植物"],
#     "语言": ["成语", "汉字", "词汇", "医学名词", "决策科学术语", "英文单词", "汉语词语", "诗作", "写作学名词", "化学名词", "数学术语", "风水学名词", "英语单词", "词作", "逻辑学说", "语言学名词", "名词", "佛教术语", "机械工程名词", "术语", "经济学名词", "诗词", "称号", "财政术语", "俗语", "物理学术语", "环境科学术语","线性代数术语", "农学术语"],
#     "食物": ["菜品", "饮品", "食品", "饮食"],
#     "其他": ["半开敞式建筑空间", "微课课程", "货币类型",  "皮肤", "法律法规"]
# }

categories = {
    "人物0": ["历史人物", "文化人物", "政治人物", "经济人物", "艺人", "演员", "作曲家", "歌手", "人物", "足球运动员", "虚拟人物", "导演", "主任", "运动员", "政治官员", "学者", "作家", "政府官员", "大学教授", "编剧", "企业家", "教授", "女生"],
    "地点1": ["乡", "村", "市", "县", "区", "省", "行政区划", "街道", "地理区域", "镇", "车站", "楼盘", "住宅场所", "公寓", "别墅", "住宿场所", "场所", "桥梁", "伏牛路142号院"],
    "自然科学2": ["卫星", "星座", "星体", "音乐", "星系", "星云", "酸碱值", "美术","化学物质", "猜想", "排名算法", "药物",  "粒子", "抑菌试验", "生物反应调节物", "功能高分子材料", "预防等级", "水稻品种", "病症", "药品", "分级基金", "三维凸均匀体", "裤型代码", "数字化工作证", "存活时间", "系统图", "仪器", "人体疾病", "病症名称", "杀虫剂", "解剖学", "化学品", "有机物", "小细支气管"],
    "组织机构3": ["公司", "企事业单位"],
    "产品4": ["汽车", "实体","虚拟物品", "游戏","计算机软件","物品", "设计", "时装"],
    "生物5": ["动物", "微生物", "植物"],
    "语言6": ["成语", "汉字","图书", "词汇","小说", "医学名词", "决策科学术语", "英文单词", "汉语词语", "诗作", "写作学名词", "化学名词", "数学术语", "风水学名词", "英语单词", "词作", "逻辑学说", "语言学名词", "名词", "佛教术语", "机械工程名词", "术语", "经济学名词", "诗词", "称号", "财政术语", "俗语", "物理学术语", "环境科学术语","线性代数术语", "农学术语"],
    "食物7": ["菜品", "饮品", "食品", "饮食"],
    "其他8": ["NAN","半开敞式建筑空间", "微课课程", "货币类型",  "皮肤", "法律法规"]
}

# 读取JSON文件，待分类的数据
with open('xin.json', 'r', encoding='utf-8') as file:
    lines = file.readlines()

# 初始化分类字典
classified_data = {category: [] for category in categories}

# 遍历每一行数据
for line in lines:
    data = json.loads(line)
    instruction = json.loads(data['instruction'])
    entity_type = instruction['schema'][0]['entity_type']
    
    # 根据实体类型分类
    for category, types in categories.items():
        if entity_type in types:
            classified_data[category].append(data)
            break

# 创建输出目录
output_dir = 'classified_data'
os.makedirs(output_dir, exist_ok=True)

# 将分类结果写入不同的JSON文件
for category, items in classified_data.items():
    output_file = os.path.join(output_dir, f'{category}.json')
    with open(output_file, 'w', encoding='utf-8') as file:
        for item in items:
            file.write(json.dumps(item, ensure_ascii=False) + '\n')

# 打印分类结果
for category, items in classified_data.items():
    print(f"{category} 分类结果:")
    for item in items:
        print(json.dumps(item, ensure_ascii=False))
    print()